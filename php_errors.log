[01-May-2025 20:49:01 Europe/Moscow] POST data: Array
(
    [name] => Аа
    [surname] => аа
    [email] => drdr@mail.ti
    [phone] => +375449999999
    [program] => Испытания Гарри Поттера
    [celebrant] => Девочка Настя
    [age] => 13
    [guests] => 10
    [location] => На природе
    [event_date] => 2025-05-03
    [wishes] => 
)

[01-May-2025 20:49:01 Europe/Moscow] Client ID: 22
[01-May-2025 20:49:01 Europe/Moscow] Form data processed: Array
(
    [name] => Аа
    [surname] => аа
    [email] => drdr@mail.ti
    [phone] => +375449999999
    [program_name] => Испытания Гарри Поттера
    [child_name] => Девочка Настя
    [child_age] => 13
    [event_date] => 2025-05-03
    [event_location] => На природе
    [guest_count] => 10
    [wishes] => 
)

[01-May-2025 20:49:01 Europe/Moscow] Validation errors: Array
(
)

[01-May-2025 20:49:01 Europe/Moscow] Program SQL query: SELECT id, animator_count 
                FROM programs 
                WHERE name = 'Испытания Гарри Поттера'
[01-May-2025 20:49:01 Europe/Moscow] Program found: ID=16, animator_count=2
[01-May-2025 20:49:01 Europe/Moscow] Animators query: 
    SELECT ap.id,
    ap.team_member_id
    FROM animator_programs ap
    WHERE ap.program_id = 16

[01-May-2025 20:49:01 Europe/Moscow] Bookings query: 
    SELECT booked_animators.id, team_member_id, booking_id
    FROM booked_animators
    JOIN bookings ON booked_animators.booking_id = bookings.id
    WHERE bookings.event_date = '2025-05-03'

[01-May-2025 20:49:01 Europe/Moscow] Booked animators: Array
(
    [0] => 1
    [1] => 2
)

[01-May-2025 20:49:01 Europe/Moscow] Available animators: Array
(
    [0] => 1
    [1] => 2
    [2] => 3
    [3] => 4
)

[01-May-2025 20:49:01 Europe/Moscow] Free animators: Array
(
    [0] => 3
    [1] => 4
)

[01-May-2025 20:49:01 Europe/Moscow] Transaction started
[01-May-2025 20:49:01 Europe/Moscow] Insert booking query: 
        INSERT INTO bookings (user_id, program_id, child_name, child_age, event_date, event_location, guest_count, wishes)
        VALUES (22, 16, 'Девочка Настя', 13, '2025-05-03', 'На природе', 10, '')
[01-May-2025 20:49:01 Europe/Moscow] Booking created with ID: 53
[01-May-2025 20:49:01 Europe/Moscow] Insert animator query: 
            INSERT INTO booked_animators (booking_id, team_member_id)
            VALUES (53, 3)
[01-May-2025 20:49:01 Europe/Moscow] Insert animator query: 
            INSERT INTO booked_animators (booking_id, team_member_id)
            VALUES (53, 4)
[01-May-2025 20:49:01 Europe/Moscow] Transaction committed successfully
[01-May-2025 20:49:01 Europe/Moscow] Redirecting to profile.php
[01-May-2025 20:57:42 Europe/Moscow] POST data: Array
(
    [name] => Аа
    [surname] => аа
    [email] => drdr@mail.ti
    [phone] => +375449999999
    [program] => Понивилль
    [celebrant] => Девочка Настя
    [age] => 13
    [guests] => 10
    [location] => На природе
    [event_date] => 2025-05-03
    [wishes] => 
)

[01-May-2025 20:57:42 Europe/Moscow] Client ID: 22
[01-May-2025 20:57:42 Europe/Moscow] Form data processed: Array
(
    [name] => Аа
    [surname] => аа
    [email] => drdr@mail.ti
    [phone] => +375449999999
    [program_name] => Понивилль
    [child_name] => Девочка Настя
    [child_age] => 13
    [event_date] => 2025-05-03
    [event_location] => На природе
    [guest_count] => 10
    [wishes] => 
)

[01-May-2025 20:57:42 Europe/Moscow] Validation errors: Array
(
)

[01-May-2025 20:57:42 Europe/Moscow] Program SQL query: SELECT id, animator_count 
                FROM programs 
                WHERE name = 'Понивилль'
[01-May-2025 20:57:42 Europe/Moscow] Program found: ID=2, animator_count=2
[01-May-2025 20:57:42 Europe/Moscow] Animators query: 
    SELECT ap.team_member_id
    FROM animator_programs ap
    WHERE ap.program_id = 2

[01-May-2025 20:57:42 Europe/Moscow] Bookings query: 
    SELECT COUNT(DISTINCT ba.team_member_id) as booked_count
    FROM booked_animators ba
    JOIN bookings b ON ba.booking_id = b.id
    WHERE b.event_date = '2025-05-03'

[01-May-2025 20:57:42 Europe/Moscow] Total animators: 6, Booked: 2, Available: 4, Required: 2
[01-May-2025 20:57:42 Europe/Moscow] Free animators for program: Array
(
    [0] => 1
    [1] => 2
)

[01-May-2025 20:57:42 Europe/Moscow] Transaction started
[01-May-2025 20:57:42 Europe/Moscow] Insert booking query: 
        INSERT INTO bookings (user_id, program_id, child_name, child_age, event_date, event_location, guest_count, wishes)
        VALUES (22, 2, 'Девочка Настя', 13, '2025-05-03', 'На природе', 10, '')
[01-May-2025 20:57:42 Europe/Moscow] Booking created with ID: 54
[01-May-2025 20:57:42 Europe/Moscow] Insert animator query: 
            INSERT INTO booked_animators (booking_id, team_member_id)
            VALUES (54, 1)
[01-May-2025 20:57:42 Europe/Moscow] Insert animator query: 
            INSERT INTO booked_animators (booking_id, team_member_id)
            VALUES (54, 2)
[01-May-2025 20:57:42 Europe/Moscow] Transaction committed successfully
[01-May-2025 20:57:42 Europe/Moscow] Redirecting to profile.php
